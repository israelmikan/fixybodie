<!DOCTYPE html>
<html>
  <head>
          
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
      <title>
      
      </title>
      
      <script type="text/javascript">
         var watchID;
         var geoLoc;
         
         function showLocation(position) {
            var latitude = position.coords.latitude;
            var longitude = position.coords.longitude;
            localStorage.cutylat=latitude;
            localStorage.custylong=longitude;
           // alert("Latitude : " + latitude + " Longitude: " + longitude);
             //alert("Customer atambudde Latitude : " + latitude + " Longitude: " + longitude);
             //localStorage.bodalaty=latitude;
            //localstorage.bodalongy=longitude;
			
                   }
            
     function errorHandler(err) {
            if(err.code == 1) {
               alert("Error: Access is denied! try Again and turn location On");
               // window.location.assign("orders.html");
                
            }
            
            else if( err.code == 2) {
               alert("Error: Position is unavailable!");
                window.location.assign("index.html");
            }
         }
         
         function getLocationUpdate(){
			             if(navigator.geolocation){
               // timeout at 60000 milliseconds (60 seconds)
               var options = {timeout:6000};
               geoLoc = navigator.geolocation;
               watchID = geoLoc.watchPosition(showLocation, errorHandler, options);
            }
            
            else{
               alert("Sorry, browser does not support geolocation!");
            }
         }
    function fireUp(){
		
		 var messageListRef = new Firebase("https://amhungry.firebaseio.com/orders/"+localStorage.mykey);
messageListRef.update({ latitude: localStorage.custylat, longitude: localStorage.custylong}, onComplete);  
      console.log("Customer location Details updated Successfully wow");
     
		}
    </script>
     <script>
			
		</script>
        <script src="https://cdn.firebase.com/js/client/2.4.2/firebase.js"></script>
      <script>
			if (localStorage.getItem("located") === null) {
			  //...
			//window.location.assign("login.html")
			
			
			}
          var boda=localStorage.getItem("located");
		  
		  function logoutMe(){
alert("You Have Choosen To Logout");
localStorage.removeItem("located");
localStorage.removeItem("bodatag");
window.location.assign("index.html");
     }
		</script>
      
 <style>
    .mybutton{
        border: thick;
        height:50px;
        background-color: black;
        color: white;
        font-family: serif;
    }
</style>
      
    </head>
    
    <body onLoad="getLocationUpdate();">
     
       <script>
     function auth(){
        console.log("auth");
    var messageListRef = new Firebase("https://amhungry.firebaseio.com/orders");
    messageListRef.authWithPassword({
      email    :localStorage.authemail,
      password : localStorage.authpassword
    }, function(error, authData) {
      if (error) {
        switch (error.code) {
          case "INVALID_EMAIL":
            console.log("The specified user account email is invalid.");
            break;
          case "INVALID_PASSWORD": 
            console.log("The specified user account password is incorrect.");
            break;
          case "INVALID_USER":
            console.log("The specified user account does not exist.");
            break;
          default:
            console.log("Error logging user in:", error);
        }
      } else {
        console.log("Authenticated successfully with payload:", authData);
          //alert("Authetication Working");
         
      }
    });
    //end of auth
   
} 
         
   
 var messageListRef = new Firebase("https://amhungry.firebaseio.com/orders");
  messageListRef.once("value", function(allMessagesSnapshot) {
           
    document.write("<div class='img-wrapper'><center><img src='img/piss.png' alt='' width='40%' height='150px'></center></div>");    
        document.write("<center><h3>Your  Order To be delivered</h3><hr></center>");
		
		          
      allMessagesSnapshot.forEach(function(messageSnapshot) {
        // Will be called with a messageSnapshot for each child under the /messages/ node
        var key = messageSnapshot.key();  // e.g. "-JqpIO567aKezufthrn8"
        var order_id = messageSnapshot.child("order_id").val();  // e.g. "barney"
        var hotel = messageSnapshot.child("hotel").val();  // e.g. "Welcome to Bedrock City!"
		var qty = messageSnapshot.child("qty").val(); 
		var saletype = messageSnapshot.child("saletype").val(); 
		var total = messageSnapshot.child("total").val(); 
		var contact=messageSnapshot.child("contact").val();
		var latitude= messageSnapshot.child("latitude").val(); 
		var longitude = messageSnapshot.child("longitude").val(); 
          var order_status=messageSnapshot.child("orderstatus").val();
		  if(order_status=="delivered"){
			 localStorage.orderkey=null;
			 localStorage.mykey=null;
			alert("You Dont have Any current Orders");
			 window.location.assign("index.html");
			  }
		  console.log(saletype);
          if(key==localStorage.mykey){
              document.write("<hr>");		
      document.write("Order Code:   "+order_id);
      document.write("<table border='2' width='100%' class='listed'><tr><td>"+hotel+"</td><td>Quantity"+qty+"</td></tr><tr><td>"+total+"</td><td>"+contact+"</td></tr><tr><td> What: "+saletype+" &nbsp; Status:"+order_status+"</td><td><a href='viewboda.html?key="+key+"&order_id="+order_id+"&hotel="+hotel+"&qty="+qty+"&saletype="+saletype+"&total="+total+"&contact="+contact+"&latitude="+latitude+"&longitude="+longitude+"' class='deli'><input type='button' style='background-color:black;color:white;' value='View Boda' class='deli'></a></td></tr></table>");
          document.write("<hr>");	
              
              
          }else{
              
          }
		
		  
		//alert(hotel);
		
		//alert(saletype);
		//alert(total);
      });
    }); 
     
      </script>
   
    
    </body>
</html>